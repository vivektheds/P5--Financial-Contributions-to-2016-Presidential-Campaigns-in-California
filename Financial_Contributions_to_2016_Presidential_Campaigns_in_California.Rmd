---
output:
  html_document: default
  pdf_document: default
---
Exploration of Financial Contributions to Presidential Campaigns in California by Vivek Pandey.

---
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
chooseCRANmirror(graphics=FALSE, ind=1)
knitr::opts_chunk$set(echo = TRUE)
```

# Abstract:
In 2016 United State presidential election Donald Trump J. became 45th president of US. There were many factors which contributed in winning US presidential election and  Financial contribution from US contributors was one of the factor which impacted that election outcome.  
In this project, I am going to investigate the financial factor that could potentially contribute to the outcome of the 2016 presidential election campaign, and for this exploratory data analysis I chose California state data because I live here and second reason is that Donald Trump lost in California despite of winning US president election,.
so I am interested in doing  research demographics and geographical distribution of contributors/donors  for each party and each candidate and find out the trends of the campaign, and at the end my research will be focused on two primarily rivals Donald Trump J. and Hillary Clinton.

For this research I got the financial data from [FEC site]( https://classic.fec.gov/disclosurep/pnational.do). This dataset contains financial contribution transaction from 05-Nov-2013 to 31-Dec-2016, and using California dataset I will try to answer below questions:

1- Which candidate and party did receive the most support in California in terms of money and no of supporters.
2- What do these contributors do and how does contributors'  occupation and gender impact the contribution towards a particular candidate and a party and are there any pattern in that.
3- Where do these donations come from geographically?
4- Also I am interested in contribution pattern over course of election campaign and how it is varying when election was approaching. 




```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using in your analysis in this code
# chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.

# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.
#install.packages('ggthemes')
#install.packages('gender')
#install.packages('ggmap')
#install.packages('lubridate')
#install.packages('zipcode')
#install.packages('aod')

suppressMessages(library(ggplot2))
suppressMessages(library(dplyr))
suppressMessages(library(ggthemes))
suppressMessages(library(gridExtra))
suppressMessages(library(gender))
suppressMessages(library(ggmap))
suppressMessages(library(lubridate))
suppressMessages(library(zipcode))
suppressMessages(library(aod))
suppressMessages(library(tidyr))
suppressMessages(library(stringr))
suppressMessages(library(reshape2))
suppressMessages(library(gender))
suppressMessages(library(maps))
suppressMessages(library(choroplethr))
suppressMessages(library(choroplethrMaps))
#install.packages("devtools")
suppressMessages(library(devtools))
#install_github('arilamstein/choroplethrZip@v1.4.0')
suppressMessages(library(choroplethrZip))
```


```{r echo=FALSE, Load_the_Data}

CA_FEC <- read.csv("P00000001_CA.csv", row.names = NULL,stringsAsFactors = F)
Col_names <- names(CA_FEC)[2:length(names(CA_FEC))] 
CA_FEC <- select(CA_FEC, -18)
names(CA_FEC) <- Col_names
CA_FEC$election_tp <- NULL

str(CA_FEC)

```

> This dataset consists of 17 variables with 1304346 observations.


```{r echo=FALSE, Summaries}

summary(CA_FEC$contb_receipt_amt)

```

> After looking at summary of contribution amount received we found that min amount is negative 10500 which can  not be less than 0.

>Also mean amount is 116.2 which is because of some of people has contributed a way more money than average contribution amount which is impacting the mean contributing amount.
Hence median 27 is better option to find out average contributing amount.
Since we can not have contributing amount less than 0 hence I have decided to remove those observations from the dataset. 

```{r echo=FALSE, Refined_summary}

CA_FEC1 <-subset(CA_FEC,CA_FEC$contb_receipt_amt>0 )

summary(CA_FEC1$contb_receipt_amt)
#ca_refund <- subset(CA_FEC,CA_FEC$contb_receipt_amt<0)
#View(ca_refund)
#unique(ca_refund$receipt_desc)
#unique(ca_refund$memo_text)
```


> After removing negative contributing amount data we found that median is still $27 which is giving accurate average contribution amount, also as per summary 75% contributors contributed upto $99. 


# Data Preparation:
> For this dataset exploratory analysis I would require to know gender of each contributors which I can derive from the first name of the contributor using 'gender' package, moreover I would also need to know which party does each candidate belong to, in addition to this for geographical analysis I would need to know geographical location (latitude and longitude), hence these three new dimensions/variables are require for this analysis.


```{r echo=FALSE, Data_Preparation}

# Create Gender variable-

# Find out the first name from contbr_nm column and clean up the first name

contbr_nm_split <- colsplit(CA_FEC1$contbr_nm, ", ", 
                            c("contbr_last", "contbr_first"))
CA_FEC1 <- cbind(CA_FEC1, contbr_nm_split)

first_name_clean = function(first_name) {
  trimmed_name = str_trim(first_name)
  if (grepl("\\(|\\'",trimmed_name)){
  cleaned_name = gsub(".*[\\'\\(](.*)[\\'\\)].*", "\\1", trimmed_name)
  return(cleaned_name) 
  } else if (grepl(" ",trimmed_name)) {
    cleaned_name = substring(trimmed_name, 1, regexpr(" ", trimmed_name)-1)
  return(cleaned_name)
  } else {
    cleaned_name = trimmed_name
    return(cleaned_name)
  }
}

CA_FEC1$contbr_first = sapply(CA_FEC1$contbr_first, first_name_clean)
gender <-  gender(CA_FEC1$contbr_first, c(1932, 1998), 
                  method = "ssa", 
                  countries = "United States")
names(gender)[1] = "contbr_first"
gender <- unique(gender)
CA_FEC1 <- merge(CA_FEC1, gender[, c("contbr_first", "gender")])


```

```{r echo=FALSE, Party_Location_Variables}

# Create party variable

democratic <- c("Clinton, Hillary Rodham", 
              "Sanders, Bernard", 
	    "Lessig, Lawrence", 
              "Webb, James Henry Jr.",
              "O'Malley, Martin Joseph")
CA_FEC1$party <- ifelse(CA_FEC1$cand_nm %in% democratic, "democratic", "republican")


# Create latitude and longitude variables from zipcode

data(zipcode)
CA_FEC1$contbr_zip <- substr(CA_FEC1$contbr_zip, 1, 5)
zipcode_CA <- subset(zipcode, state == "CA")[,-c(2,3)]
colnames(zipcode_CA) <- c("contbr_zip", "latitude", "longitude")
CA_FEC1 <- merge(CA_FEC1, zipcode_CA)

```



> After adding six new variables first_nm, last_nm,gender,party,longitude and latitude now we have 23 variables in the updated dataset with 1237421 observations.

# Univariate Plots Section

```{r echo=FALSE, Univariate_Plots}

#qplot(x=contb_receipt_amt, data =CA_FEC1, fill='Orange'  )
ggplot(aes(x = contb_receipt_amt),data=CA_FEC1 )+
        geom_histogram() +
        scale_y_continuous(name="No of contributors", labels = scales::comma)
```



```{r echo=FALSE, Univariate_Plots1}

#qplot(x=contb_receipt_amt, data =CA_FEC1, binwidth=30,fill='Orange'  )
ggplot(aes(x = contb_receipt_amt),data=CA_FEC1 )+
        geom_histogram(binwidth=30) +
        scale_y_continuous(name="No of contributors", labels = scales::comma)
```

> I have analyzed the distribution of contrubution amount and as per the above two graphs contribution amount is right skewed, so we can apply square root transformation to better visualize this distribution.


```{r echo=FALSE, Univariate_Plots2}

#qplot(x=contb_receipt_amt, data =CA_FEC1, binwidth=30,fill='Orange'  )
       
ggplot(CA_FEC1, aes(sqrt(contb_receipt_amt))) + 
 geom_histogram() + 
        scale_x_sqrt("Contribution amount Sqrt-scaling")+
        scale_y_continuous(name="No of contributors", labels = scales::comma)
       
```


> After square root transformation we can say that most of the contributers are contributing less amount of money which is around less than $100, however some are contributing large ampount of money.



```{r echo=FALSE, Univariate_Summary_Gender}

Contr_gender_df <- group_by(CA_FEC1, CA_FEC1$gender)
Gender_Cnt <-arrange(summarize(Contr_gender_df, count = n()), desc(count)) 
Gender_Cnt

```

> The above gender summary tells us that more no of females were contributing in financial campaign.

```{r echo=FALSE, Univariate_Summary_Occupation}

Contr_occupation_df <- group_by(CA_FEC1, contbr_occupation)
#head(Contr_occupation_df)
Occupation_Cnt <-arrange(summarize(Contr_occupation_df, count = n()), desc(count)) 
#length(unique(CA_FEC1$contbr_occupation))

#Occupation_Cnt[1:10,]
#length(unique(Occupation_Cnt$`CA_FEC1$contbr_occupation`))

ggplot(subset(Occupation_Cnt[1:10,]), aes(contbr_occupation, count)) +
        geom_bar(stat="identity",fill="#f18d00") +
        geom_text(aes(label=count), vjust=-0.3, color="black", size=3.5) +
        theme_minimal() +
        theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
        scale_y_continuous(name="Total no of contribution", labels = scales::comma)

```


> As there are so many occupations reported and in order to focus on more common occupations I have selected only Top 10 occupations that contributed to US presidential candidate.
As per the above graph we can see that retired people has contributed most in US presidential campaign and followed by "Not Employed"" who can be freelancers, after that significant no of people from  "Attorney", "INFORMATION REQUESTED" and "TEACHER" professions are actively contributing.
However it is strange that retired and not employed people have contributed most instead of emmployed and high paid professionals. 


# Univariate Analysis


### What is the structure of your dataset?

> There are 1304346 financial contribution transactions for different president candidates in the dataset with 17 features such as cand_nm,contbr_nm,contbr_city, contbr_zip, contbr_occupation etc.

> Other observations:
- Some contribution amounts were negative which we have removed from the dataset.
- Median contribution amount is $27.
- As per summary 75% contributors contributed upto $99. 
- More no of females were contributing in US presidential financial campaign.
- Most no of people who contributed are retired peole.

### What is/are the main feature(s) of interest in your dataset?

> The main feature is contb_receipt_amt and I want to do analysis on contb_receipt_amt distribution using it's summary with other variables to find out the patterns if any.

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?

> I think that cand_nm,contbr_nm,contbr_city, contbr_zip, contbr_occupation and contb_receipt_dt columns can help us to understand the patterns in 2016 US presidential election campaign.

### Did you create any new variables from existing variables in the dataset?

> I have created six new variables first_nm, last_nm, gender, party, longitude and latitude to find out the most relevant factors which impacted most in 2016 US presidential election.

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?

> I found some negative contributing amount which was unusal hence I have removed those transactions from the final data which I have used for analysis.
I square root transformed the right skewed contribution amount, and after that transformation we were able to better visualize amount distribution and it seems most of the contributers are contributing less amount of money which is around less than $100.

# Bivariate Plots Section



```{r echo=FALSE, Contribution_Amount_by_party}

#by (CA_FEC1$contb_receipt_amt,CA_FEC1$cand_nm,sum)

Funding_By_party <- CA_FEC1 %>%
 group_by(party) %>%
 summarise(Total_Amount = sum(contb_receipt_amt)) 

Funding_By_party <- Funding_By_party %>%
  mutate_if(., is.numeric, as.numeric)

Funding_By_party <- Funding_By_party %>%
        arrange(desc(Total_Amount))

Funding_By_party


```


```{r echo=FALSE, BivariatePlot_by_party}

ggplot(Funding_By_party, aes(party, Total_Amount,fill=party)) +
        geom_bar(stat="identity") +
        geom_text(aes(label=Total_Amount), vjust=1.6, color="black", size=3.5) +
        theme_minimal() +
        scale_fill_manual(values=c("#41b8f4", "#ff7777")) +
        scale_y_continuous(name="Total Amount Received", labels = scales::comma)

```

> As per the above graph of total amount received by party tells us that democratic party received almost 3 times more money than republican party, and democratic party seems most favourite in California for 2016 US president election.

> Next I will try to find out top one candidate from each party who received maximum contribution.


```{r echo=FALSE, Contribution_Amount_received_by_Candt_Summary}

#by (CA_FEC1$contb_receipt_amt,CA_FEC1$cand_nm,sum)

Funding_By_Candt <- CA_FEC1 %>%
 group_by(cand_nm) %>%
 summarise(Amount_Sum = sum(contb_receipt_amt)) 

Funding_By_Candt <- Funding_By_Candt %>%
  mutate_if(., is.numeric, as.numeric)

Funding_By_Candt <- Funding_By_Candt %>%
        arrange(desc(Amount_Sum))

```



```{r echo=FALSE, Contribution_Amount_by_party_Cand_nm}

#by (CA_FEC1$contb_receipt_amt,CA_FEC1$cand_nm,sum)

Funding_By_party_cand_nm <- CA_FEC1 %>%
 group_by(party,cand_nm) %>%
 summarise(Total_Amount = sum(contb_receipt_amt)) 

Funding_By_party_cand_nm <- Funding_By_party_cand_nm %>%
  mutate_if(., is.numeric, as.numeric)

Funding_By_party_cand_nm <- Funding_By_party_cand_nm %>%
        arrange(desc(Total_Amount))

```



```{r echo=FALSE, BivariatePlot_by_party_cand_nm}

ggplot(Funding_By_party_cand_nm, aes(cand_nm, Total_Amount,fill=party)) +
        geom_bar(stat="identity") +
         theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
        #geom_text(aes(label=Total_Amount), vjust=-0.3, size=3.5) +
        #geom_text(aes(label=Total_Amount), vjust=1.6, color="black", size=3.5) +
        #theme_minimal() +
        scale_fill_manual(values=c("#41b8f4", "#ff7777")) +
        scale_y_continuous(name="Total Amount Received", labels = scales::comma)

```

> As per the above contribution amount received by candidate bar graph we can say that Clinton, Hillary received highest funding in California which is around $ 95 Million and that is more than 4 times funding received by any other candidates.Hence it gives us very positive sentiments that Clinton, Hillary has very good chance of winning in California.
In addition to this Sanders, Bernard and Trump, Donald J. have received 20 Million and 14 Million respectively which are a way less than amount received by Clinton, Hillary, so they are second and third popular candidate in California.



```{r echo=FALSE, Contribution_Amount_percntg_by_party_Cand_nm}

#by (CA_FEC1$contb_receipt_amt,CA_FEC1$cand_nm,sum)


Funding_By_party_cand_nm <- Funding_By_party_cand_nm %>%
    group_by(party) %>%
    mutate(Sum_by_party= sum(Total_Amount)) %>%
    group_by(cand_nm, add=TRUE) %>%
    mutate(per=round(100*Total_Amount/Sum_by_party,2))
   

#Funding_By_party_cand_nm$per<- as.numeric(as.character(Funding_By_party_cand_nm$per))

```


```{r echo=FALSE, BivariatePlot_by_Democratic_cand_per}

 ggplot(subset(Funding_By_party_cand_nm,party=="democratic"), aes(cand_nm, per,fill=party)) +
        geom_bar(stat="identity", width=0.5) +
         theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
        geom_text(aes(label=per), vjust=-0.3, size=3.5) +
        #geom_text(aes(label=Total_Amount), vjust=1.6, color="black", size=3.5) +
        #theme_minimal() +
        scale_fill_manual(values=c("#41b8f4")) +
        scale_y_continuous(name="Percentage Amount Received", labels = scales::comma)



```




```{r echo=FALSE, BivariatePlot_by_Republican_cand_per}

ggplot(subset(Funding_By_party_cand_nm,party=="republican"), aes(cand_nm, per,fill=party)) +
        geom_bar(stat="identity", width=0.5) +
         theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
        geom_text(aes(label=per), vjust=-0.3, size=3.5) +
        #geom_text(aes(label=Total_Amount), vjust=1.6, color="black", size=3.5) +
        #theme_minimal() +
        scale_fill_manual(values=c("#ff7777")) +
        scale_y_continuous(name="Percentage Amount Received", labels = scales::comma)

```


> As per the above graphs of contribution received by individual candidates of each party we can say that majority of contribution is concentrated on top contenders within each party.
For Democratic party 99% of contributing amount received in California goes to Hillary Clinton and Bernard Sanders, and of which 81.69% goes to Hillary Clinton.
For Republican party 66% amount goes to top three candidates Donald Trump, Rafael Ted Cruz and Rubio Marco, and of which 34% goes to Donald Trump, and 24% goes to other four candidates and rest of 12 candidates received 10% contributing amount.

> As I wanted to find out top 5 candidates who received maximum contributing amount so from the above analysis two candidates from Democratic party are Hillary Clinton ,Bernard Sanders and three candidates from Republican party are Donald Trump, Rafael Ted Cruz and Rubio Marco.
I will take these five candidates for time series analysis to find out the pattern if California people were more inclined towards any party or any particular candidate.



```{r echo=FALSE, Party_Summary_Occupation}

occupation_Democratic_df <- group_by(subset(CA_FEC1,party=="democratic"), contbr_occupation,party)
occupation_Democratic_df <-arrange(summarize(occupation_Democratic_df, count = n()), desc(count)) 
occupation_Democratic_df<- occupation_Democratic_df[1:10,]
#occupation_Democratic_df

occupation_republican_df <- group_by(subset(CA_FEC1,party=="republican"), contbr_occupation,party)
occupation_republican_df <-arrange(summarize(occupation_republican_df, count = n()), desc(count)) 
occupation_republican_df<- occupation_republican_df[1:10,]

occupation_party_df <- rbind(occupation_Democratic_df, occupation_republican_df)


```



```{r echo=FALSE, Plot_Party_Summary_Occupation}

plot <- ggplot(occupation_party_df, aes(contbr_occupation, count, fill=party))
plot <- plot + geom_bar(stat = "identity", position = 'dodge') +
        theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
        scale_fill_manual(values=c("#41b8f4", "#ff7777")) +
        ggtitle("Top 10 Contributors for each party")
plot

#ggplot(subset(occupation_party_df,party=="republican"), aes(contbr_occupation,count)) +
 #       geom_bar(stat="identity",fill="#f18d00") +
  #      geom_text(aes(label=count), vjust=-0.3, color="black", size=3.5) +
   #     theme_minimal() +
    #    theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
     #   scale_y_continuous(name="Total no of contribution", labels = scales::comma)

```

> As per the above graph we can say that across all top 10 occupations democratic party got majority contribution which is far more than republican party.
Majority of Retired people contributed to Democratic party however all Not employed people who belongs to second highest contributor's profession had contributed to Democratic party only and it gives clear indication that Not employed people disparately wanted democratic party in power.


# Contribution by Gender:

```{r echo=FALSE, Summary_by_Gender}

Funding_By_Gender_party_cand_nm <- CA_FEC1 %>%
 group_by(gender,party,cand_nm) %>%
 summarise(Total_Amount = sum(contb_receipt_amt)) 

Funding_By_Gender_party_cand_nm <- Funding_By_Gender_party_cand_nm %>%
  mutate_if(., is.numeric, as.numeric)

Funding_By_Gender_party_cand_nm <- Funding_By_Gender_party_cand_nm %>%
        arrange(desc(Total_Amount))

View(Funding_By_Gender_party_cand_nm)


```



```{r echo=FALSE, Summary_by_Gender_party_candi}

funding_gender <- CA_FEC1 %>%
 group_by(gender) %>%
 summarise(Total_Amount = sum(contb_receipt_amt)) 

#funding_gender

funding_gender_party <- CA_FEC1 %>%
 group_by(gender,party) %>%
 summarise(Total_Amount = sum(contb_receipt_amt)) 

funding_gender_party


```


```{r echo=FALSE, BivariatePlot_by_Gender}

#funding_gender

#funding_gender_party

ggplot(funding_gender, aes(gender, Total_Amount,fill=gender)) +
        geom_bar(stat="identity") +
        geom_text(aes(label=Total_Amount), vjust=-0.3, color="black", size=3.5) +
       # theme_minimal() + 
        scale_fill_brewer(palette="Dark2") +
        scale_y_continuous(name="Total Amount Received", labels = scales::comma)

#View(Funding_By_Gender_party_cand_nm)

```

> As gender is also very important variable to analyze to find out whether male or female was contributing more,and as per above contributing amount received by gender graph shows that male has contributed more money than female.
However Hillary Clinton was one of the very popular female candidate for US 2016 election, so I am very much interested to do further analysis to find out if female has contributed more to Hillary clinton.


```{r echo=FALSE, BivariatePlot_by_Gender_party}

#funding_gender

#funding_gender_party

ggplot(funding_gender_party, aes(gender, Total_Amount,fill=party)) +
        geom_bar(stat="identity", position = position_dodge()) +
        geom_text(stat = 'identity', position = position_dodge(0.9),aes(label=Total_Amount), vjust=-0.3, color="black", size=3.0) +
       # theme_minimal() + 
        scale_fill_manual(values=c("#41b8f4", "#ff7777")) +
        #scale_fill_brewer(palette="Dark2") +
        scale_y_continuous(name="Total Amount Received", labels = scales::comma)

#View(Funding_By_Gender_party_cand_nm)

```

> As per the above graph we can say that female has contributed 4 times more to democratic party than republican and this influence can be because of female president candidate Hillary clinton, so I want to investigate further by candidate and party.


```{r echo=FALSE, BivariatePlot_by_Gender_party_candi}


ggplot(Funding_By_Gender_party_cand_nm, aes(cand_nm, Total_Amount,fill=gender)) +
        geom_bar(stat="identity", position = position_dodge()) +
        theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
        #geom_text(stat = 'identity', position = position_dodge(0.9),aes(label=Total_Amount), vjust=-0.3, color="black", size=3.0) +
       # theme_minimal() + 
        #scale_fill_manual(values=c("#41b8f4", "#ff7777")) +
         scale_fill_brewer(palette="Dark2") +
        #scale_fill_brewer(palette="Dark2") +
        scale_y_continuous(name="Total Amount Received", labels = scales::comma)



```


> After looking at contribution by gender and candidate we can say that female has mainly contributed to Hillary clinton. 



# Bivariate Analysis


### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?

> Most of the total contribution in California went to the Democratic party which is almost 3 times more than republican party.
- Within each party, the majority of contributions were received by top contenders.
- For Democratic party 99% of contributing amount received in California goes to Hillary Clinton and Bernard Sanders, and of which 81.69% goes to Hillary Clinton.
- In California majority of the contributions from female contributors went to Democratic party and female candidate.
- Most of these contributions from female were made to Hillary Clinton.



### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?

> Majority of Retired people contributed to Democratic party however surprisingly all Not employed people who belongs to second highest contributor's profession had contributed to Democratic party only.

### What was the strongest relationship you found?

> Male had higher contributing amount than female. 


# Multivariate Plots Section

## Contribution by Geographical Location:


```{r echo=FALSE, BivariatePlot_by_Location}

map_ca = map_data('county', 'california')
main_area <- data.frame(
  city = c("San francisco",
           "Los Angeles",
           "Sacramento", 
           "Fresno",  
           "San Diego"),
  longitude = c(-122.43,-118.2,-121.5,-119.8,-116.2),
  latitude = c(37.7,34.5, 39.0, 37.0, 33.0)
)

ggplot() + 
  geom_polygon(data = map_ca, aes(x = long, y = lat, group = group), 
               colour = "black", fill = "#BBDAA4") + 
  geom_point(data = CA_FEC1, 
             aes(x = longitude, y = latitude, alpha = 1/110), 
             color = "#e34a33") + 
  geom_text(data = main_area, 
            aes(longitude, latitude, label = city), 
            size = 4, fontface = "bold", colour = "black") + 
  theme_tufte() + 
  xlab("Latitude") + 
  ylab("Longitude") + 
  ggtitle("Geographical Location of Contributors") + 
  theme(legend.position = "none",
        plot.title = element_text(size = 16),
        axis.title = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(angle = 90, hjust = 1, vjust = .4))
```

> As per the above graph we can say that majority of contribution were coming from major cities of California which are San Francisco, Los Angeles, Sacramento and San Diego.


```{r echo=FALSE, BivariatePlot_by_Location_party}

map_ca = map_data('county', 'california')
main_area <- data.frame(
  city = c("San francisco",
           "Los Angeles",
           "Sacramento", 
           "Fresno",  
           "San Diego"),
  longitude = c(-122.43,-118.2,-121.5,-119.8,-116.2),
  latitude = c(37.7,34.5, 39.0, 37.0, 33.0)
)

plot1<- ggplot() + 
  geom_polygon(data = map_ca, aes(x = long, y = lat, group = group), 
               colour = "black", fill = "#BBDAA4") + 
  geom_point(data =subset(CA_FEC1,party=="democratic"), 
             aes(x = longitude, y = latitude, alpha = 1/110), 
             color = "#41b8f4") + 
  geom_text(data = main_area, 
            aes(longitude, latitude, label = city), 
            size = 4, fontface = "bold", colour = "black") + 
  theme_tufte() + 
  xlab("Latitude") + 
  ylab("Longitude") + 
  ggtitle("Democratic Contribution received") + 
  theme(legend.position = "none",
        plot.title = element_text(size = 16),
        axis.title = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(angle = 90, hjust = 1, vjust = .4))

plot2<- ggplot() + 
  geom_polygon(data = map_ca, aes(x = long, y = lat, group = group), 
               colour = "black", fill = "#BBDAA4") + 
  geom_point(data =subset(CA_FEC1,party=="republican"), 
             aes(x = longitude, y = latitude, alpha = 1/110), 
             color = "#ff7777") + 
  geom_text(data = main_area, 
            aes(longitude, latitude, label = city), 
            size = 4, fontface = "bold", colour = "black") + 
  theme_tufte() + 
  xlab("Latitude") + 
  ylab("Longitude") + 
  ggtitle("Republican Contribution received") + 
  theme(legend.position = "none",
        plot.title = element_text(size = 16),
        axis.title = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(angle = 90, hjust = 1, vjust = .4))

grid.arrange(plot1, plot2, ncol = 1)

```

`
> As per the previous analysis democratic party received more contribution in California however I wanted to analyze further the distribution of contributing amount across California whether all across California people were contributing more to Democratic party, however as per the above graph we can not conclude that Democratic party received more contribution all across California and it seems both parties received majority of their contribution from major cities of California.


## Contribution by Time Series:


```{r echo=FALSE, Multivariate_Data}

CA_FEC1$Mon_year <- format(as.Date(CA_FEC1$contb_receipt_dt, "%d-%b-%y"),"%b-%y")

       
Contr_by_Mon_yyyy <- CA_FEC1 %>%
 group_by(Mon_year) %>%
 summarise(Total_Amount = sum(contb_receipt_amt)) 

#format("01-Apr-15", "%d-%b-%Y")
#as.Date(paste("01-", "Apr-15"), "%d-%b-%y")
#replace(paste("01-","Apr-15")," ","")

Contr_by_Mon_yyyy$Mon_year <-gsub(" ", "", paste("1-",Contr_by_Mon_yyyy$Mon_year)) 
Contr_by_Mon_yyyy$Mon_year<- as.Date(Contr_by_Mon_yyyy$Mon_year, "%d-%b-%y")
#class(Contr_by_Mon_yyyy$Mon_year)
#Contr_by_Mon_yyyy$Mon_year


```



```{r echo=FALSE, Multivariate_data1}

       
Contr_by_Candi_Mon_yy <- CA_FEC1 %>% 
      filter(cand_nm %in% c("Clinton, Hillary Rodham", "Sanders, Bernard" ,"Trump, Donald J.","Rubio, Marco" ,"Cruz, Rafael Edward 'Ted'" )) %>% 
 group_by(cand_nm,Mon_year) %>%
 summarise(Total_Amount = sum(contb_receipt_amt)) 

#format("01-Apr-15", "%d-%b-%Y")
#as.Date(paste("01-", "Apr-15"), "%d-%b-%y")
#replace(paste("01-","Apr-15")," ","")

Contr_by_Candi_Mon_yy$Mon_year <-gsub(" ", "", paste("1-",Contr_by_Candi_Mon_yy$Mon_year)) 
Contr_by_Candi_Mon_yy$Mon_year<- as.Date(Contr_by_Candi_Mon_yy$Mon_year, "%d-%b-%y")
#class(Contr_by_Candi_Mon_yy$Mon_year)
#Contr_by_Candi_Mon_yy$Mon_year


```




```{r echo=FALSE, Multivariate_Plots}



library(ggplot2)
theme_set(theme_minimal())

ggplot(data = Contr_by_Mon_yyyy, aes(x = Mon_year, y = Total_Amount))+
  geom_line(color = "#00AFBB", size = 1) +
        scale_y_continuous(name="Total Amount Received", labels = scales::comma)

```

> As per the above time series graph of contribution amount over course of US presidential financial campaign we can say that financial contribution in california was keep increasing and it was very high when election was approaching.  
Also I will be doing this time series analysis on top 5 candidates and will analysis how it varies during the election campaign.

```{r echo=FALSE, Multivariate_Plots_by_Candidate}



library(ggplot2)
theme_set(theme_minimal())

ggplot(data = Contr_by_Candi_Mon_yy, aes(x = Mon_year, y = Total_Amount))+
  geom_line(aes(color = cand_nm), size = 1) + 
       # geom_area(aes(color = cand_nm, fill = cand_nm),   alpha = 0.5, position = position_dodge(0.8)) +
         scale_x_date(date_labels  = "%b-%Y")+
        scale_y_continuous(name="Total Amount Received", labels = scales::comma)
         

```


> As per the above time series graph of contribution received by top 5 candidates in California we can say that from 2014 the start of the US presidential financial campaign till eight months before the election Bernard Sanders's contribution amount received was appraching to Hillary Clinton's contribution amount and other candidates were also getting decent contribution from California people and surprisingly Trump received least amount among  these five candidates.
However, in the last 8 months of campaign only Hillary clinton was getting a beyond financial suport from California people and one more very surprise thing was that Trump was started getting very significant amount of contribution in california which was giving positive sentiments towards Trump though Hillary Clinton was most favorite.


# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?

> Majority of contribution came from top five major cities of California.
- Hillary Clinton was dominating all time during Financial Campagin as far as contributing amount is concerned.
- While closer to election, Hillary Clinton started getting a beyond financial support in California.
- While closer to the election,surprisingly Trump also started getting very good support in California however not as much as Hillary Clinton.

### Were there any interesting or surprising interactions between features?

> For a certain period of time, Bernard Sanders received more donations and gained more popularity than Hillary Clinton.


------

# Final Plots and Summary

### Most Contribution went to a few candidates

```{r echo=FALSE, Plot_One}

ggplot(Funding_By_party_cand_nm, aes(cand_nm, Total_Amount,fill=party)) +
        geom_bar(stat="identity") +
         theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
        #geom_text(aes(label=Total_Amount), vjust=-0.3, size=3.5) +
        #geom_text(aes(label=Total_Amount), vjust=1.6, color="black", size=3.5) +
        #theme_minimal() +
        ggtitle('Contribution Amount Received by Candidates from Their Own Party') +
        scale_fill_manual(values=c("#41b8f4", "#ff7777")) +
        scale_y_continuous(name="Total Amount Received", labels = scales::comma)


```

> In Califoria democratic party received a way more contributing amount than republican party,and within democratic party Hillary Clinton received highest funding in California which is around $95 Million and that is more than 4 times funding received by any other candidates.
Moreover, majority of contribution is concentrated on top contenders within each party ,and Bernard Sanders (democratic) and Donald Trump(republican) have received 20 Million and 14 Million respectively which were a way less than amount received by Hillary Clinton, so they were second and third popular candidate in California.
For republican party Rafael Ted Cruz and Rubio Marco were two other top contenders as far as republican contributing amount is concerned.
 


### Female contributed less than male however female contributed more to female candidate:

```{r echo=FALSE, Plot_Two}

Funding_By_Gender_cand_nm <- Funding_By_Gender_party_cand_nm %>% 
      filter(cand_nm %in% c("Clinton, Hillary Rodham", "Sanders, Bernard" ,"Trump, Donald J.","Rubio, Marco" ,"Cruz, Rafael Edward 'Ted'" ))

ggplot(Funding_By_Gender_cand_nm, aes(cand_nm, Total_Amount,fill=gender)) +
        geom_bar(stat="identity", position = position_dodge()) +
        theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
        #geom_text(stat = 'identity', position = position_dodge(0.9),aes(label=Total_Amount), vjust=-0.3, color="black", size=3.0) +
       # theme_minimal() + 
        xlab("Candidates") +
         scale_fill_brewer(palette="Dark2") +
        ggtitle('Contribution Amount Received by Gender and Candidates') +
        scale_y_continuous(name="Total Amount Received", labels = scales::comma)

```

> In California male has contributed more money than female, and as per previous analysis female has contributed more to democratic party and from the above graph of top five candidates we can say that female contributors dominantly contributed to Hillary Clinton, and it gives us clear pattern that female are highly inclined to contribute to female candidate and on the other hand male are contributing more to male candidates. 


### Contribution by Occupation

```{r echo=FALSE, Plot_Three}

plot_profession <- ggplot(occupation_party_df, aes(contbr_occupation, count, fill=party))
plot_profession <- plot_profession + geom_bar(stat = "identity", position = 'dodge') +
        theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
        scale_fill_manual(values=c("#41b8f4", "#ff7777")) +
        xlab("Occupations")+
        ylab("No of Contributors") +
        ggtitle("Contribution for each party by Top 10 Professions")
plot_profession

```

> Across all top 10 occupations democratic party got majority contribution which is far more than republican party.
Most of Retired people contributed to Democratic party however surprisingly all Not employed people who belongs to second highest contributor's profession had contributed to Democratic party only.


------

# Reflection

### Struggles:
> The 2016 presidential campaign contributions dataset for California state contains over 289901 observations.
While analyzing this dataset I came across multiple challenges and issues.
 - The original dataset didn't has gender information and in order to analyze contribution by gender I have used 'gender' R package to derive gender from the first name of contributors.
 - For geographical analysis longitude and latitude were require however the original dataset had only zipcode of contributor, so I had used 'zipcode' R package to derive these two attributes from zipcode, and I have used ggmap to analyze contributors by location.
 - I was not thoroughly aware of US presidential election process, so before doing any analysis I had to spent some time to acquire this fundamental knowledge so that my analysis should not be biased.

### Conclusion:
> After analyzing California financial contribution data I came across many interesting findings and patterns.
- Democratic party received more contribution than republican party.
- The Majority of contribution was received by top contenders.
- Female contributors contributed more to Democratic party and female candidate.
- Female made maximum contribution to Hillary Clinton.
- Retired people contributed more to Democratic party however surprisingly Not employed people had contributed to only Democratic party. 
- Majority of contribution came from top five major cities of California.
- For a certain period of time, Bernard Sanders received more contribution and gained more popularity than Hillary Clinton.


### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?

> Majority of Retired people contributed to Democratic party however surprisingly all Not employed people who belongs to second highest contributor's profession had contributed to Democratic party only.



### Future Work:
> I analyzed 2016 US presidential financial campaign data for California state and came across some popular president contenders and their finding in California however it would be very interesting to analyze other states financial campaign data as well as nationwide data so that we can predict accurately which candidate and party had very good chance of winning the president election based on financial campaign across US.



> **Tip**: Here's the final step! Reflect on the exploration you performed and
the insights you found. What were some of the struggles that you went through?
What went well? What was surprising? Make sure you include an insight into
future work that could be done with the dataset.
